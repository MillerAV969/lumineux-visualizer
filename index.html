<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LUMINEUX ‚Äî –í–∏–∑—É–∞–ª–∏–∑–∞—Ç–æ—Ä —É–∫—Ä–∞—à–µ–Ω–∏–π —Å –ø—Ä–æ–µ–∫—Ç–∞–º–∏</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Cormorant+Garamond:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root { --gold: #FFD700; --dark-gold: #B8860B; --dark: #0a0e1a; --light-dark: #141824; --white: #FFFFFF; --gray: #a0a8b8; --snow: #E8F4F8; }
        html { scroll-behavior: smooth; }
        body { font-family: 'Cormorant Garamond', serif; background: linear-gradient(135deg, #0a0e1a 0%, #141824 50%, #1a1f33 100%); color: var(--white); line-height: 1.8; font-weight: 300; overflow-x: hidden; position: relative; }
        
        body::before { content: ''; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(circle at 20% 30%, rgba(255, 215, 0, 0.05) 0%, transparent 40%), radial-gradient(circle at 80% 70%, rgba(255, 215, 0, 0.03) 0%, transparent 40%); pointer-events: none; z-index: 0; }
        
        .starfield { position: fixed; width: 100%; height: 100%; top: 0; left: 0; z-index: -1; }
        .star { position: absolute; background: white; border-radius: 50%; animation: twinkle 3s infinite; }
        @keyframes twinkle { 0%, 100% { opacity: 0.3; } 50% { opacity: 1; } }
        
        .moon { position: fixed; top: 50px; right: 100px; width: 80px; height: 80px; background: radial-gradient(circle at 30% 30%, #FFD700, #FFA500); border-radius: 50%; box-shadow: 0 0 40px rgba(255, 215, 0, 0.3); z-index: -1; }
        
        .deco-tree { position: fixed; top: 80px; right: 50px; font-size: 120px; z-index: -1; opacity: 0.8; filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.3)); animation: sway 3s ease-in-out infinite; }
        @keyframes sway { 0%, 100% { transform: rotate(0deg); } 50% { transform: rotate(2deg); } }
        
        h1, h2, h3, h4 { font-family: 'Playfair Display', serif; font-weight: 600; }
        
        header { background: linear-gradient(180deg, rgba(10, 14, 26, 0.95) 0%, rgba(20, 24, 36, 0.9) 100%); padding: 40px 30px; text-align: center; border-bottom: 2px solid rgba(255, 215, 0, 0.2); position: relative; z-index: 2; }
        .logo { font-size: 42px; color: var(--gold); letter-spacing: 5px; text-transform: uppercase; text-shadow: 0 0 20px rgba(255, 215, 0, 0.4); }
        .tagline { font-size: 18px; color: var(--snow); margin-top: 15px; }
        
        .container { max-width: 1400px; margin: 0 auto; padding: 60px 30px; position: relative; z-index: 2; }
        
        .projects-panel { background: rgba(26, 31, 51, 0.8); padding: 30px; border-radius: 12px; margin-bottom: 40px; border: 2px solid rgba(255, 215, 0, 0.2); }
        .projects-title { font-size: 24px; color: var(--gold); margin-bottom: 20px; }
        .projects-list { display: flex; gap: 15px; overflow-x: auto; padding-bottom: 10px; }
        .project-btn { padding: 12px 20px; background: rgba(10, 14, 26, 0.8); border: 2px solid rgba(255, 215, 0, 0.3); color: var(--white); border-radius: 8px; cursor: pointer; transition: all 0.3s ease; white-space: nowrap; }
        .project-btn:hover { border-color: var(--gold); background: rgba(26, 31, 51, 0.9); }
        .project-btn.active { background: var(--gold); color: var(--dark); border-color: var(--gold); }
        .add-project { padding: 12px 20px; background: transparent; border: 2px solid var(--gold); color: var(--gold); border-radius: 8px; cursor: pointer; font-weight: 600; transition: all 0.3s ease; }
        .add-project:hover { background: var(--gold); color: var(--dark); }
        
        .project-info { padding: 15px; background: rgba(255, 215, 0, 0.1); border-radius: 8px; margin-bottom: 20px; border-left: 4px solid var(--gold); }
        .project-selections { font-size: 14px; color: var(--snow); line-height: 1.8; }
        
        .upload-section { background: linear-gradient(135deg, rgba(26, 31, 51, 0.6) 0%, rgba(20, 24, 36, 0.6) 100%); padding: 50px; border-radius: 12px; margin-bottom: 50px; border: 2px solid rgba(255, 215, 0, 0.15); box-shadow: 0 10px 50px rgba(0, 0, 0, 0.5); }
        
        .preview-container { display: grid; grid-template-columns: 1.5fr 1fr; gap: 40px; margin-top: 60px; align-items: flex-start; }
        .preview-image { position: relative; overflow: hidden; border-radius: 12px; aspect-ratio: 4/3; background: var(--light-dark); border: 2px solid rgba(255, 215, 0, 0.2); box-shadow: 0 10px 50px rgba(0, 0, 0, 0.5); }
        .preview-img { width: 100%; height: 100%; object-fit: cover; transition: filter 0.5s ease; }
        
        .filters-panel { padding: 30px; background: rgba(26, 31, 51, 0.7); border-radius: 12px; max-height: 650px; overflow-y: auto; border: 1px solid rgba(255, 215, 0, 0.15); }
        .category-section { margin-bottom: 30px; padding-bottom: 25px; border-bottom: 1px solid rgba(255, 215, 0, 0.1); }
        .category-section:last-child { border-bottom: none; }
        .category-title { font-size: 16px; text-transform: uppercase; letter-spacing: 2px; color: var(--gold); margin-bottom: 18px; font-weight: 600; display: flex; align-items: center; gap: 10px; }
        
        .filter-option { display: flex; align-items: center; padding: 14px; margin-bottom: 10px; background: rgba(10, 14, 26, 0.6); border-radius: 8px; cursor: pointer; transition: all 0.3s ease; border: 2px solid transparent; }
        .filter-option:hover { border-color: var(--gold); background: rgba(26, 31, 51, 0.8); transform: translateX(5px); }
        .filter-option input { width: 20px; height: 20px; cursor: pointer; margin-right: 14px; accent-color: var(--gold); }
        .filter-label { font-size: 15px; color: var(--snow); flex: 1; display: flex; align-items: center; }
        .filter-label img { width: 40px; height: 40px; border-radius: 6px; margin-right: 12px; object-fit: cover; border: 1px solid rgba(255, 215, 0, 0.3); }
        
        .action-buttons { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        .btn { padding: 14px; border-radius: 8px; border: none; cursor: pointer; font-size: 15px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; transition: all 0.3s ease; }
        .btn-add { background: rgba(255, 215, 0, 0.2); color: var(--gold); border: 2px solid var(--gold); }
        .btn-add:hover { background: var(--gold); color: var(--dark); }
        .btn-view { background: rgba(70, 130, 180, 0.3); color: #87CEEB; border: 2px solid #87CEEB; }
        .btn-view:hover { background: #87CEEB; color: var(--dark); }
        .btn-send { background: linear-gradient(135deg, var(--gold) 0%, var(--dark-gold) 100%); color: var(--dark); border: none; width: 100%; }
        .btn-send:hover { transform: translateY(-2px); box-shadow: 0 10px 40px rgba(255, 215, 0, 0.5); }
        
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 1000; align-items: center; justify-content: center; }
        .modal.active { display: flex; }
        .modal-content { background: var(--light-dark); padding: 40px; border-radius: 12px; max-width: 500px; border: 2px solid var(--gold); }
        .modal-title { font-size: 24px; color: var(--gold); margin-bottom: 20px; }
        .modal-input { width: 100%; padding: 12px; background: rgba(10, 14, 26, 0.8); border: 1px solid rgba(255, 215, 0, 0.3); color: var(--white); border-radius: 6px; margin-bottom: 20px; font-size: 16px; }
        .modal-buttons { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        
        ::-webkit-scrollbar { width: 10px; }
        ::-webkit-scrollbar-track { background: rgba(10, 14, 26, 0.5); }
        ::-webkit-scrollbar-thumb { background: var(--gold); border-radius: 5px; }
        
        @media (max-width: 1024px) { .preview-container { grid-template-columns: 1fr; } }
        @media (max-width: 768px) { .container { padding: 30px 15px; } .projects-list { flex-wrap: wrap; } }
    </style>
</head>
<body>
    <!-- –ó–í–ï–ó–î–ù–û–ï –ù–ï–ë–û -->
    <div class="starfield" id="starfield"></div>
    <div class="moon"></div>
    <div class="deco-tree">üéÑ</div>
    
    <header>
        <div class="logo">‚ú® Lumineux ‚ú®</div>
        <p class="tagline">üéÑ –°–æ–∑–¥–∞–≤–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç—ã: –ø—Ä–∏–º–µ—Ä—è–π—Ç–µ —É–∫—Ä–∞—à–µ–Ω–∏—è, –∫–æ–º–±–∏–Ω–∏—Ä—É–π—Ç–µ, –æ—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ –≤ —Ä–∞–±–æ—Ç—É</p>
    </header>

    <div class="container">
        <!-- –ü–ê–ù–ï–õ–¨ –ü–†–û–ï–ö–¢–û–í -->
        <div class="projects-panel">
            <div class="projects-title">üìã –í–∞—à–∏ –ø—Ä–æ–µ–∫—Ç—ã</div>
            <div class="projects-list" id="projectsList"></div>
            <button class="add-project" onclick="createNewProject()">+ –ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç</button>
        </div>

        <!-- –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –ü–†–û–ï–ö–¢–ï -->
        <div class="project-info" id="projectInfo">
            <div style="font-size: 14px; color: var(--gray); margin-bottom: 10px;">üìù –í–´–ë–†–ê–ù–ù–´–ï –£–ö–†–ê–®–ï–ù–ò–Ø:</div>
            <div class="project-selections" id="projectSelections">
                (–í—ã–±–µ—Ä–∏—Ç–µ —É–∫—Ä–∞—à–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞)
            </div>
        </div>

        <!-- –ó–ê–ì–†–£–ó–ö–ê –§–û–¢–û -->
        <div class="upload-section">
            <div class="upload-area" onclick="document.getElementById('photoInput').click()" id="uploadArea">
                <div style="font-size: 80px; margin-bottom: 20px; filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.5));">üì∏</div>
                <div style="font-size: 24px; color: var(--gold); margin-bottom: 12px; font-weight: 600;">–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ –≤–∞—à–µ–≥–æ –¥–æ–º–∞</div>
                <div style="font-size: 16px; color: var(--gray);">–°—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—Ä—É–π—Ç–µ –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ –∏–∑ –≥–∞–ª–µ—Ä–µ–∏</div>
                <input type="file" id="photoInput" style="display: none;" accept="image/*" capture="environment">
            </div>

            <div class="preview-container" id="previewContainer" style="display: none;">
                <div class="preview-image">
                    <img id="previewImg" class="preview-img" src="" alt="Preview">
                </div>

                <div class="filters-panel">
                    <!-- –ì–ò–†–õ–Ø–ù–î–´ -->
                    <div class="category-section">
                        <div class="category-title">
                            <span>üí°</span> –ì–∏—Ä–ª—è–Ω–¥—ã
                        </div>
                        
                        <div class="filter-option">
                            <input type="checkbox" id="garland-fringe-white" name="garland" value="–ë–∞—Ö—Ä–æ–º–∞ –±–µ–ª–∞—è" onchange="updateProject()">
                            <label for="garland-fringe-white" class="filter-label">
                                <img src="https://user-gen-media-assets.s3.amazonaws.com/seedream_images/c0ca66f8-2da5-4fe2-be6c-62b09ff50f74.png">
                                –ë–∞—Ö—Ä–æ–º–∞ –±–µ–ª–∞—è
                            </label>
                        </div>

                        <div class="filter-option">
                            <input type="checkbox" id="garland-fringe-yellow" name="garland" value="–ë–∞—Ö—Ä–æ–º–∞ –∂—ë–ª—Ç–∞—è" onchange="updateProject()">
                            <label for="garland-fringe-yellow" class="filter-label">
                                <img src="https://user-gen-media-assets.s3.amazonaws.com/seedream_images/b66a3a68-0cfe-4e85-aaa6-3db6a1859dc1.png">
                                –ë–∞—Ö—Ä–æ–º–∞ –∂—ë–ª—Ç–∞—è
                            </label>
                        </div>

                        <div class="filter-option">
                            <input type="checkbox" id="garland-neon-white" name="garland" value="–î—é—Ä–æ–ª–∞–π—Ç –±–µ–ª—ã–π" onchange="updateProject()">
                            <label for="garland-neon-white" class="filter-label">
                                <img src="https://user-gen-media-assets.s3.amazonaws.com/seedream_images/ac2cb769-abe5-4315-b494-33da9edfe56a.png">
                                –î—é—Ä–æ–ª–∞–π—Ç –±–µ–ª—ã–π
                            </label>
                        </div>

                        <div class="filter-option">
                            <input type="checkbox" id="garland-neon-yellow" name="garland" value="–î—é—Ä–æ–ª–∞–π—Ç –∂—ë–ª—Ç—ã–π" onchange="updateProject()">
                            <label for="garland-neon-yellow" class="filter-label">
                                <img src="https://user-gen-media-assets.s3.amazonaws.com/seedream_images/22a24c4e-f6d0-4474-b593-6319f1874cec.png">
                                –î—é—Ä–æ–ª–∞–π—Ç –∂—ë–ª—Ç—ã–π
                            </label>
                        </div>

                        <div class="filter-option">
                            <input type="checkbox" id="garland-beltlight" name="garland" value="–ë–µ–ª—Ç–ª–∞–π—Ç" onchange="updateProject()">
                            <label for="garland-beltlight" class="filter-label">
                                <img src="https://user-gen-media-assets.s3.amazonaws.com/seedream_images/0a7bc676-68bc-4580-ac19-9004c6f58875.png">
                                –ë–µ–ª—Ç–ª–∞–π—Ç
                            </label>
                        </div>

                        <div class="action-buttons">
                            <button class="btn btn-add" onclick="addSelectionToProject()">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
                            <button class="btn btn-view" onclick="viewSeparate()">üëÅÔ∏è –û—Ç–¥–µ–ª—å–Ω–æ</button>
                        </div>
                    </div>

                    <!-- –Å–õ–ö–ò -->
                    <div class="category-section">
                        <div class="category-title">
                            <span>üéÑ</span> –Å–ª–∫–∏
                        </div>
                        
                        <div class="filter-option">
                            <input type="checkbox" id="tree-3m" name="tree" value="–Å–ª–∫–∞ 3–º –∑–æ–ª–æ—Ç–æ" onchange="updateProject()">
                            <label for="tree-3m" class="filter-label">–Å–ª–∫–∞ 3–º (–∑–æ–ª–æ—Ç–æ)</label>
                        </div>

                        <div class="filter-option">
                            <input type="checkbox" id="tree-5m" name="tree" value="–Å–ª–∫–∞ 5–º –±–µ–ª–∞—è" onchange="updateProject()">
                            <label for="tree-5m" class="filter-label">–Å–ª–∫–∞ 5–º (–±–µ–ª–∞—è)</label>
                        </div>

                        <div class="filter-option">
                            <input type="checkbox" id="tree-8m" name="tree" value="–Å–ª–∫–∞ 8–º –º–∏–∫—Å" onchange="updateProject()">
                            <label for="tree-8m" class="filter-label">–Å–ª–∫–∞ 8–º (–º–∏–∫—Å)</label>
                        </div>

                        <div class="action-buttons">
                            <button class="btn btn-add" onclick="addSelectionToProject()">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
                            <button class="btn btn-view" onclick="viewSeparate()">üëÅÔ∏è –û—Ç–¥–µ–ª—å–Ω–æ</button>
                        </div>
                    </div>

                    <!-- –í–•–û–î–ù–´–ï –ì–†–£–ü–ü–´ -->
                    <div class="category-section">
                        <div class="category-title">
                            <span>üö™</span> –í—Ö–æ–¥–Ω—ã–µ –≥—Ä—É–ø–ø—ã
                        </div>
                        
                        <div class="filter-option">
                            <input type="checkbox" id="entrance-wreath" name="entrance" value="–í–µ–Ω–æ–∫ LED" onchange="updateProject()">
                            <label for="entrance-wreath" class="filter-label">–í–µ–Ω–æ–∫ LED</label>
                        </div>

                        <div class="filter-option">
                            <input type="checkbox" id="entrance-arch" name="entrance" value="–°–≤–µ—Ç–æ–≤–∞—è –∞—Ä–∫–∞" onchange="updateProject()">
                            <label for="entrance-arch" class="filter-label">–°–≤–µ—Ç–æ–≤–∞—è –∞—Ä–∫–∞</label>
                        </div>

                        <div class="action-buttons">
                            <button class="btn btn-add" onclick="addSelectionToProject()">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
                            <button class="btn btn-view" onclick="viewSeparate()">üëÅÔ∏è –û—Ç–¥–µ–ª—å–Ω–æ</button>
                        </div>
                    </div>

                    <!-- –§–ò–ì–£–†–´ -->
                    <div class="category-section">
                        <div class="category-title">
                            <span>ü¶å</span> –§–∏–≥—É—Ä—ã
                        </div>
                        
                        <div class="filter-option">
                            <input type="checkbox" id="figure-deer" name="figure" value="–û–ª–µ–Ω–∏ LED" onchange="updateProject()">
                            <label for="figure-deer" class="filter-label">–û–ª–µ–Ω–∏ LED</label>
                        </div>

                        <div class="filter-option">
                            <input type="checkbox" id="figure-santa" name="figure" value="–°–∞–Ω—Ç–∞ —Å —Å–∞–Ω—è–º–∏" onchange="updateProject()">
                            <label for="figure-santa" class="filter-label">–°–∞–Ω—Ç–∞ —Å —Å–∞–Ω—è–º–∏</label>
                        </div>

                        <div class="filter-option">
                            <input type="checkbox" id="figure-snowman" name="figure" value="–°–Ω–µ–≥–æ–≤–∏–∫ LED" onchange="updateProject()">
                            <label for="figure-snowman" class="filter-label">–°–Ω–µ–≥–æ–≤–∏–∫ LED</label>
                        </div>

                        <div class="action-buttons">
                            <button class="btn btn-add" onclick="addSelectionToProject()">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
                            <button class="btn btn-view" onclick="viewSeparate()">üëÅÔ∏è –û—Ç–¥–µ–ª—å–Ω–æ</button>
                        </div>
                    </div>

                    <!-- –ü–û–î–°–í–ï–¢–ö–ê –î–ï–†–ï–í–¨–ï–í -->
                    <div class="category-section">
                        <div class="category-title">
                            <span>üå≤</span> –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –¥–µ—Ä–µ–≤—å–µ–≤
                        </div>
                        
                        <div class="filter-option">
                            <input type="checkbox" id="tree-light-gold" name="tree-light" value="–ó–æ–ª–æ—Ç–∞—è –æ–±–º–æ—Ç–∫–∞" onchange="updateProject()">
                            <label for="tree-light-gold" class="filter-label">–ó–æ–ª–æ—Ç–∞—è –æ–±–º–æ—Ç–∫–∞</label>
                        </div>

                        <div class="filter-option">
                            <input type="checkbox" id="tree-light-cascade" name="tree-light" value="–ö–∞—Å–∫–∞–¥–Ω–∞—è –ø–æ–¥—Å–≤–µ—Ç–∫–∞" onchange="updateProject()">
                            <label for="tree-light-cascade" class="filter-label">–ö–∞—Å–∫–∞–¥–Ω–∞—è –ø–æ–¥—Å–≤–µ—Ç–∫–∞</label>
                        </div>

                        <div class="action-buttons">
                            <button class="btn btn-add" onclick="addSelectionToProject()">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
                            <button class="btn btn-view" onclick="viewSeparate()">üëÅÔ∏è –û—Ç–¥–µ–ª—å–Ω–æ</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ö–ù–û–ü–ö–ê –û–¢–ü–†–ê–í–ö–ò -->
            <div style="margin-top: 40px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px;" id="sendButtonContainer" style="display: none;">
                <button class="btn" style="background: rgba(70, 130, 180, 0.3); color: #87CEEB; border: 2px solid #87CEEB; cursor: pointer;" onclick="downloadProjectSummary()">üì• –°–∫–∞—á–∞—Ç—å –ø—Ä–æ–µ–∫—Ç</button>
                <button class="btn btn-send" onclick="sendProject()">‚úâÔ∏è –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –≤ —Ä–∞–±–æ—Ç—É</button>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û -->
    <div class="modal" id="projectModal">
        <div class="modal-content">
            <div class="modal-title">üìã –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞</div>
            <input type="text" id="projectNameInput" class="modal-input" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: '–î–æ–º —Å –≥–∏—Ä–ª—è–Ω–¥–∞–º–∏ –∏ —ë–ª–∫–æ–π'">
            <div class="modal-buttons">
                <button class="btn" style="background: rgba(100,100,100,0.5); border: none; color: var(--white);" onclick="closeModal()">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn btn-send" onclick="confirmProjectName()">–°–æ–∑–¥–∞—Ç—å</button>
            </div>
        </div>
    </div>

    <script>
        // –ó–í–ï–ó–î–´
        function createStarfield() {
            const starfield = document.getElementById('starfield');
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.width = Math.random() * 3 + 'px';
                star.style.height = star.style.width;
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 60 + '%';
                star.style.animationDelay = Math.random() * 3 + 's';
                starfield.appendChild(star);
            }
        }
        createStarfield();

        // –î–ê–ù–ù–´–ï –ü–†–û–ï–ö–¢–û–í
        let projects = JSON.parse(localStorage.getItem('projects')) || [];
        let currentProjectId = null;
        let tempSelection = {};

        function renderProjects() {
            const list = document.getElementById('projectsList');
            list.innerHTML = '';
            projects.forEach((p, idx) => {
                const btn = document.createElement('button');
                btn.className = `project-btn ${currentProjectId === p.id ? 'active' : ''}`;
                btn.textContent = `${p.name} (${p.selections.length})`;
                btn.onclick = () => selectProject(p.id);
                list.appendChild(btn);
            });
        }

        function createNewProject() {
            document.getElementById('projectModal').classList.add('active');
            document.getElementById('projectNameInput').value = '';
        }

        function confirmProjectName() {
            const name = document.getElementById('projectNameInput').value.trim();
            if (!name) { alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ'); return; }
            
            const project = {
                id: Date.now(),
                name: name,
                selections: [],
                photo: null
            };
            projects.push(project);
            currentProjectId = project.id;
            saveProjects();
            renderProjects();
            closeModal();
            updateProjectInfo();
        }

        function closeModal() {
            document.getElementById('projectModal').classList.remove('active');
        }

        function selectProject(id) {
            currentProjectId = id;
            renderProjects();
            updateProjectInfo();
            tempSelection = {};
            clearCheckboxes();
        }

        function addSelectionToProject() {
            if (!currentProjectId) { alert('–°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç'); return; }
            
            const selected = getSelectedItems();
            if (selected.length === 0) { alert('–í—ã–±–µ—Ä–∏—Ç–µ —É–∫—Ä–∞—à–µ–Ω–∏–µ'); return; }
            
            const project = projects.find(p => p.id === currentProjectId);
            project.selections.push(...selected);
            saveProjects();
            updateProjectInfo();
            clearCheckboxes();
        }

        function viewSeparate() {
            const selected = getSelectedItems();
            if (selected.length === 0) { alert('–í—ã–±–µ—Ä–∏—Ç–µ —É–∫—Ä–∞—à–µ–Ω–∏–µ'); return; }
            alert(`–ü—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç–¥–µ–ª—å–Ω–æ:\n\n${selected.join('\n')}`);
        }

        function getSelectedItems() {
            const items = [];
            document.querySelectorAll('.filter-option input:checked').forEach(cb => {
                items.push(cb.value);
            });
            return items;
        }

        function clearCheckboxes() {
            document.querySelectorAll('.filter-option input:checked').forEach(cb => {
                cb.checked = false;
            });
        }

        function updateProject() {
            document.getElementById('sendButtonContainer').style.display = currentProjectId ? 'grid' : 'none';
        }

        function updateProjectInfo() {
            if (!currentProjectId) return;
            const project = projects.find(p => p.id === currentProjectId);
            if (!project) return;
            
            const info = document.getElementById('projectSelections');
            if (project.selections.length === 0) {
                info.innerHTML = '(–í—ã–±–µ—Ä–∏—Ç–µ —É–∫—Ä–∞—à–µ–Ω–∏—è –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞)';
            } else {
                info.innerHTML = project.selections.map((s, i) => `${i+1}. ${s}`).join('<br>');
            }
        }

        function sendProject() {
            if (!currentProjectId) { alert('–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç'); return; }
            const project = projects.find(p => p.id === currentProjectId);
            
            const message = `–ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç: "${project.name}"\n\n–£–∫—Ä–∞—à–µ–Ω–∏—è:\n${project.selections.map(s => '‚Ä¢ ' + s).join('\n')}`;
            alert('‚úâÔ∏è –ü—Ä–æ–µ–∫—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!\n\n' + message);
        }

        function downloadProjectSummary() {
            if (!currentProjectId) { alert('–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç'); return; }
            const project = projects.find(p => p.id === currentProjectId);
            
            const summary = `–ü–†–û–ï–ö–¢: ${project.name}\n\n–£–ö–†–ê–®–ï–ù–ò–Ø:\n${project.selections.map((s, i) => `${i+1}. ${s}`).join('\n')}`;
            const blob = new Blob([summary], {type: 'text/plain'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${project.name}.txt`;
            a.click();
        }

        function saveProjects() {
            localStorage.setItem('projects', JSON.stringify(projects));
        }

        // –§–û–¢–û
        document.getElementById('photoInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    document.getElementById('previewImg').src = event.target.result;
                    document.getElementById('previewContainer').style.display = 'grid';
                    document.getElementById('sendButtonContainer').style.display = 'grid';
                };
                reader.readAsDataURL(file);
            }
        });

        renderProjects();
    </script>
</body>
</html>
